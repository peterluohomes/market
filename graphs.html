<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRREB Market Statistics - January 2026</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(180deg, #e8f4fc 0%, #f5f0e8 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 12px 24px;
            background: linear-gradient(135deg, #1a365d 0%, #2d4a7c 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(26, 54, 93, 0.3);
        }
        
        .nav-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(26, 54, 93, 0.4);
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, #c5a03e 0%, #d4af37 50%, #c5a03e 100%);
            color: #1a365d;
            box-shadow: 0 4px 16px rgba(212, 175, 55, 0.5);
        }
        
        /* Chart Container */
        .chart-wrapper {
            position: relative;
            background: linear-gradient(180deg, #d6e8f5 0%, #f5ece0 60%, #e8d5b8 100%);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            height: 80vh;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }
        
        
        .chart-container {
            position: relative;
            padding: 30px 40px 20px 40px;
            z-index: 1;
            flex: 1;
            min-height: 0;
            display: flex;
            flex-direction: column;
        }
        
        /* Legend */
        .legend-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #2d4a7c;
        }
        
        .legend-dot {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
        
        /* Current Value Annotation */
        .current-value {
            position: absolute;
            right: 120px;
            top: 50%;
            transform: translateY(-50%);
            text-align: left;
            z-index: 10;
        }
        
        .current-value .month-year {
            color: #0d7a3e;
            font-weight: 700;
            font-size: 18px;
        }
        
        .current-value .value {
            color: #0d7a3e;
            font-weight: 800;
            font-size: 22px;
        }
        
        /* Footer */
        .chart-footer {
            background: transparent;
            padding: 28px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        .footer-title {
            color: #003DA5;
        }
        
        .footer-title h2 {
            font-size: 20px;
            font-weight: 800;
            letter-spacing: 1px;
        }
        
        .footer-title p {
            font-size: 14px;
            font-weight: 400;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .footer-logo {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 0;
        }
        
        .name-peter {
            font-weight: 800;
            font-size: 32px;
            color: #003DA5;
            line-height: 1;
        }
        
        .name-luo {
            font-weight: 800;
            font-size: 32px;
            color: #DC1C2E;
            line-height: 1;
            margin-left: 8px;
        }
        
        /* Canvas */
        .canvas-wrapper {
            flex: 1;
            min-height: 300px;
            position: relative;
        }
        
        #marketChart {
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
            z-index: 2;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .nav-tabs {
                gap: 5px;
            }
            
            .nav-tab {
                padding: 10px 16px;
                font-size: 12px;
            }
            
            .chart-container {
                padding: 20px 15px 90px 15px;
            }
            
            .legend-container {
                gap: 15px;
            }
            
            .legend-item {
                font-size: 11px;
            }
            
            .footer-title h2 {
                font-size: 18px;
            }
            
            .footer-title p {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-metric="avgPrice">Average Monthly Price</button>
            <button class="nav-tab" data-metric="activeListings">Number of Active Listings</button>
            <button class="nav-tab" data-metric="sales">Number of Sales</button>
            <button class="nav-tab" data-metric="newListings">Number of New Listings</button>
            <button class="nav-tab" data-metric="ldom">Average LDOM</button>
            <button class="nav-tab" data-metric="pdom">Average PDOM</button>
        </div>
        
        <!-- Chart Container -->
        <div class="chart-wrapper">
            <div class="chart-container">
                <!-- Legend -->
                <div class="legend-container" id="legendContainer"></div>
                
                <!-- Chart Canvas -->
                <div class="canvas-wrapper">
                    <canvas id="marketChart"></canvas>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="chart-footer">
                <div class="footer-title">
                    <h2>TRREB - JANUARY 2026</h2>
                    <p id="chartSubtitle">AVERAGE MONTHLY SALES PRICE</p>
                </div>
                <div class="footer-logo">
                    <span class="name-peter">Peter</span>
                    <span class="name-luo">Luo</span>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Market Data - embedded JSON
        const marketData = {
  "years": [
    2020,
    2021,
    2022,
    2023,
    2024,
    2025,
    2026
  ],
  "months": [
    "Jan",
    "Feb",
    "Mar",
    "Apr",
    "May",
    "Jun",
    "Jul",
    "Aug",
    "Sep",
    "Oct",
    "Nov",
    "Dec"
  ],
  "metrics": {
    "avgPrice": {
      "label": "Average Monthly Sales Price",
      "unit": "$",
      "data": {
        "2020": [
          838087,
          910142,
          902787,
          820222,
          863523,
          931085,
          943670,
          951467,
          960680,
          968561,
          955971,
          932222
        ],
        "2021": [
          966001,
          1044910,
          1097319,
          1090414,
          1108137,
          1089012,
          1061653,
          1070176,
          1135027,
          1155624,
          1162564,
          1157837
        ],
        "2022": [
          1242155,
          1334062,
          1298671,
          1250739,
          1210700,
          1145786,
          1073318,
          1079739,
          1086505,
          1090074,
          1079122,
          1051216
        ],
        "2023": [
          1037027,
          1096157,
          1107052,
          1152519,
          1195274,
          1181002,
          1116978,
          1082881,
          1118200,
          1123390,
          1077891,
          1084757
        ],
        "2024": [
          1025226,
          1109444,
          1120984,
          1155219,
          1167646,
          1161144,
          1106685,
          1077742,
          1106542,
          1135694,
          1106148,
          1067186
        ],
        "2025": [
          1040994,
          1084547,
          1093254,
          1107463,
          1120879,
          1101691,
          1051719,
          1022143,
          1059377,
          1054372,
          1039458,
          1006735
        ],
        "2026": [
          973289,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    },
    "activeListings": {
      "label": "Homes Available for Sale",
      "unit": "",
      "data": {
        "2020": [
          7772,
          8816,
          10676,
          10561,
          11448,
          14001,
          15018,
          16662,
          18167,
          17313,
          13798,
          7892
        ],
        "2021": [
          7396,
          8727,
          10603,
          13098,
          12247,
          11293,
          9731,
          8199,
          9187,
          7748,
          6086,
          3231
        ],
        "2022": [
          4140,
          6985,
          10167,
          11668,
          15433,
          16093,
          15334,
          13305,
          13534,
          13023,
          11910,
          8692
        ],
        "2023": [
          9300,
          9643,
          10121,
          10373,
          11869,
          14108,
          15360,
          15492,
          18906,
          19536,
          16754,
          10368
        ],
        "2024": [
          10093,
          11102,
          12459,
          17783,
          21880,
          23613,
          23877,
          22469,
          25612,
          23722,
          21818,
          15393
        ],
        "2025": [
          17157,
          19536,
          23462,
          27386,
          30964,
          31603,
          30215,
          27495,
          29394,
          27808,
          24549,
          17005
        ],
        "2026": [
          17975,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    },
    "sales": {
      "label": "Monthly Unit Sales",
      "unit": "",
      "data": {
        "2020": [
          4546,
          7193,
          7945,
          2958,
          4594,
          8649,
          11035,
          10741,
          11041,
          10519,
          8750,
          7180
        ],
        "2021": [
          6887,
          10925,
          15627,
          13613,
          11902,
          11052,
          9338,
          8550,
          9010,
          9743,
          8979,
          6013
        ],
        "2022": [
          5593,
          9028,
          10864,
          7941,
          7229,
          6424,
          4871,
          5591,
          5008,
          4940,
          4534,
          3117
        ],
        "2023": [
          3082,
          4754,
          6867,
          7487,
          8959,
          7429,
          5219,
          5251,
          4605,
          4611,
          4194,
          3419
        ],
        "2024": [
          4177,
          5563,
          6519,
          7302,
          7206,
          6177,
          5361,
          5092,
          4969,
          6784,
          5867,
          3359
        ],
        "2025": [
          3847,
          4037,
          5011,
          5601,
          6244,
          6243,
          6100,
          5211,
          5592,
          6138,
          5010,
          3697
        ],
        "2026": [
          3082,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    },
    "newListings": {
      "label": "Number of New Listings",
      "unit": "",
      "data": {
        "2020": [
          7836,
          10613,
          14424,
          6174,
          9104,
          16153,
          17956,
          18491,
          20420,
          17802,
          11545,
          5865
        ],
        "2021": [
          9438,
          15146,
          22747,
          18413,
          18593,
          16193,
          12562,
          10615,
          13494,
          11749,
          10044,
          5177
        ],
        "2022": [
          7979,
          14147,
          20038,
          20841,
          18679,
          16347,
          12046,
          10537,
          11237,
          10390,
          8880,
          4074
        ],
        "2023": [
          7836,
          8537,
          11394,
          11509,
          11363,
          15995,
          13755,
          12358,
          16377,
          14700,
          10870,
          3894
        ],
        "2024": [
          8312,
          11396,
          13120,
          17418,
          19147,
          17964,
          16296,
          12837,
          18089,
          15646,
          11592,
          4681
        ],
        "2025": [
          12392,
          12066,
          17263,
          18836,
          21819,
          19839,
          17613,
          14038,
          19260,
          16069,
          11134,
          5299
        ],
        "2026": [
          10774,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    },
    "ldom": {
      "label": "Average LDOM (Listing Days on Market)",
      "unit": "days",
      "data": {
        "2020": [
          27,
          17,
          13,
          19,
          24,
          18,
          17,
          17,
          16,
          17,
          19,
          24
        ],
        "2021": [
          24,
          14,
          10,
          11,
          11,
          13,
          14,
          16,
          14,
          13,
          13,
          14
        ],
        "2022": [
          13,
          9,
          8,
          10,
          12,
          15,
          19,
          22,
          23,
          21,
          22,
          27
        ],
        "2023": [
          29,
          22,
          19,
          17,
          14,
          14,
          17,
          20,
          20,
          21,
          25,
          32
        ],
        "2024": [
          37,
          25,
          20,
          19,
          19,
          20,
          24,
          29,
          27,
          27,
          31,
          36
        ],
        "2025": [
          37,
          28,
          24,
          25,
          25,
          26,
          30,
          33,
          33,
          31,
          34,
          41
        ],
        "2026": [
          45,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    },
    "pdom": {
      "label": "Average PDOM (Property Days on Market)",
      "unit": "days",
      "data": {
        "2020": [
          37,
          23,
          17,
          24,
          32,
          26,
          25,
          24,
          22,
          24,
          28,
          35
        ],
        "2021": [
          33,
          19,
          13,
          14,
          15,
          17,
          20,
          21,
          19,
          18,
          16,
          19
        ],
        "2022": [
          18,
          11,
          11,
          14,
          18,
          24,
          29,
          34,
          35,
          33,
          33,
          40
        ],
        "2023": [
          41,
          33,
          27,
          24,
          20,
          20,
          23,
          28,
          30,
          33,
          39,
          49
        ],
        "2024": [
          54,
          37,
          29,
          28,
          27,
          30,
          36,
          44,
          43,
          43,
          49,
          56
        ],
        "2025": [
          55,
          43,
          36,
          33,
          39,
          42,
          41,
          49,
          51,
          50,
          56,
          65
        ],
        "2026": [
          67,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ]
      }
    }
  }
};
        
        // Year colors matching the sample images
        const yearColors = {
    "2020": {
        "line": "#ef4444",
        "bg": "rgba(239, 68, 68, 0.1)"
    },
    "2021": {
        "line": "#dc2626",
        "bg": "rgba(220, 38, 38, 0.1)"
    },
    "2022": {
        "line": "#60a5fa",
        "bg": "rgba(96, 165, 250, 0.1)"
    },
    "2023": {
        "line": "#991b1b",
        "bg": "rgba(153, 27, 27, 0.1)"
    },
    "2024": {
        "line": "#6b7280",
        "bg": "rgba(107, 114, 128, 0.1)"
    },
    "2025": {
        "line": "#0d7a3e",
        "bg": "rgba(13, 122, 62, 0.1)"
    },
    "2026": {
        "line": "#8b5cf6",
        "bg": "rgba(139,92,246,0.1)"
    }
};
        
        // Subtitle mapping
        const subtitles = {
            avgPrice: 'AVERAGE MONTHLY SALES PRICE',
            activeListings: 'HOMES AVAILABLE FOR SALE',
            sales: 'MONTHLY UNIT SALES',
            newListings: 'NEW LISTINGS',
            ldom: 'AVERAGE LDOM (LISTING DAYS ON MARKET)',
            pdom: 'AVERAGE PDOM (PROPERTY DAYS ON MARKET)'
        };
        
        let chart = null;
        
        // Format number based on metric type
        function formatValue(value, metric) {
            if (metric === 'avgPrice') {
                return '$' + value.toLocaleString();
            } else if (metric === 'ldom' || metric === 'pdom') {
                return value + ' days';
            }
            return '#' + value.toLocaleString();
        }
        
        // Create legend
        function createLegend(years) {
            const container = document.getElementById('legendContainer');
            container.innerHTML = '';
            
            // Display years: 2019, 2020, 2021, 2022, 2023, 2024, 2025 (skip 2020 to match sample)
            const displayYears = marketData.years;
            
            displayYears.forEach(year => {
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-dot" style="background-color: ${yearColors[year].line}"></div>
                    <span>${year}</span>
                `;
                container.appendChild(item);
            });
        }
        
        // Create or update chart
        function createChart(metricKey) {
            const ctx = document.getElementById('marketChart').getContext('2d');
            const metric = marketData.metrics[metricKey];
            
            // Update subtitle
            document.getElementById('chartSubtitle').textContent = subtitles[metricKey];
            
            // Prepare datasets
            const datasets = [];
            const displayYears = marketData.years;
            
            displayYears.forEach(year => {
                const yearData = metric.data[year.toString()];
                if (yearData) {
                    datasets.push({
                        label: year.toString(),
                        data: yearData,
                        borderColor: yearColors[year].line,
                        backgroundColor: yearColors[year].line,
                        borderWidth: 3,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: yearColors[year].line,
                        pointBorderColor: '#fff',
                        pointBorderWidth: 1,
                        tension: 0.3,
                        fill: false
                    });
                }
            });
            
            // Destroy existing chart
            if (chart) {
                chart.destroy();
            }
            
            // Calculate y-axis range
            let allValues = [];
            Object.values(metric.data).forEach(yearData => {
                allValues = allValues.concat(yearData.filter(v => v !== null));
            });
            const maxValue = Math.max(...allValues);
            const minValue = Math.min(...allValues);
            
            // Create new chart
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: marketData.months,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 54, 93, 0.95)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            titleFont: {
                                family: 'Montserrat',
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                family: 'Montserrat',
                                size: 13
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    let value = context.raw;
                                    if (metricKey === 'avgPrice') {
                                        return context.dataset.label + ': $' + value.toLocaleString();
                                    } else if (metricKey === 'ldom' || metricKey === 'pdom') {
                                        return context.dataset.label + ': ' + value + ' days';
                                    }
                                    return context.dataset.label + ': ' + value.toLocaleString();
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    family: 'Montserrat',
                                    size: 13,
                                    weight: '600'
                                },
                                color: '#4a5568'
                            }
                        },
                        y: {
                            grid: {
                                color: 'rgba(0, 0, 0, 0.08)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    family: 'Montserrat',
                                    size: 12,
                                    weight: '500'
                                },
                                color: '#4a5568',
                                callback: function(value) {
                                    if (metricKey === 'avgPrice') {
                                        return '$' + (value / 1000000).toFixed(1) + 'M';
                                    }
                                    return value.toLocaleString();
                                }
                            },
                            beginAtZero: metricKey !== 'avgPrice'
                        }
                    }
                },
                plugins: [{
id: 'currentValueAnnotation',
    afterDraw: function(chart) {
        const ctx = chart.ctx;
        const lastDatasetIndex = chart.data.datasets.length - 1;
        const lastDataset = chart.data.datasets[lastDatasetIndex];
        const lastYear = lastDataset.label;

        // Find the rightmost non-null data point
        let lastIndex = -1;
        for (let i = 11; i >= 0; i--) {
            if (lastDataset.data[i] != null) {
                lastIndex = i;
                break;
            }
        }
        if (lastIndex === -1) return;

        const meta = chart.getDatasetMeta(lastDatasetIndex);
        const lastPoint = meta.data[lastIndex];
        const x = lastPoint.x + 20;
        const y = lastPoint.y;

        const value = lastDataset.data[lastIndex];
        const monthName = chart.data.labels[lastIndex];
        const fullMonth = {
            'Jan':'January', 'Feb':'February', 'Mar':'March', 'Apr':'April',
            'May':'May', 'Jun':'June', 'Jul':'July', 'Aug':'August',
            'Sep':'September', 'Oct':'October', 'Nov':'November', 'Dec':'December'
        }[monthName];

        // Use the same color as this year's line
        const lineColor = yearColors[lastYear]?.line || '#0d7a3e';  // fallback just in case

        ctx.save();
        
        // Month + Year
        ctx.font = 'bold 16px Montserrat';
        ctx.fillStyle = lineColor;
        ctx.textAlign = 'left';
        ctx.fillText(`${fullMonth} ${lastYear}`, x, y - 10);

        // Value
        ctx.font = 'bold 20px Montserrat';
        let formattedValue;
        if (metricKey === 'avgPrice') {
            formattedValue = '$' + value.toLocaleString();
        } else if (metricKey === 'ldom' || metricKey === 'pdom') {
            formattedValue = value + ' days';
        } else {
            formattedValue = value.toLocaleString();
        }
        
        ctx.fillStyle = lineColor;
        ctx.fillText(formattedValue, x, y + 15);

        ctx.restore();
    }
}]
            });
            
            createLegend(displayYears);
        }
        
        // Tab click handlers
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Update active state
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Update chart
                const metric = this.getAttribute('data-metric');
                createChart(metric);
            });
        });
        
        // Initialize with first metric
        createChart('avgPrice');
    </script>
</body>
</html>
